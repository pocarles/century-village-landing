---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description?: string;
  canonicalURL?: string;
  ogImage?: string;
  noindex?: boolean;
}

const siteUrl = "https://centurysync.com";

const {
  title,
  description = "Florida COA management platform built for Century Village West Palm Beach. Stay compliant with HB 1021 & HB 913. Document management, owner communication, compliance tracking for 309 associations.",
  canonicalURL = Astro.url.href,
  ogImage = `${siteUrl}/og-image.png`,
  noindex = false
} = Astro.props;

const siteTitle = title === "Home" ? "CenturySync | Smarter Florida COA Management for Century Village" : `${title} | CenturySync`;
const absoluteOgImage = ogImage.startsWith('http') ? ogImage : `${siteUrl}${ogImage}`;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{siteTitle}</title>
  <meta name="description" content={description}>

  <!-- Robots -->
  {noindex ? (
    <meta name="robots" content="noindex, nofollow">
  ) : (
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  )}

  <!-- Canonical URL -->
  <link rel="canonical" href={canonicalURL}>

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:url" content={canonicalURL}>
  <meta property="og:title" content={siteTitle}>
  <meta property="og:description" content={description}>
  <meta property="og:image" content={absoluteOgImage}>
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:site_name" content="CenturySync">
  <meta property="og:locale" content="en_US">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content={siteTitle}>
  <meta name="twitter:description" content={description}>
  <meta name="twitter:image" content={absoluteOgImage}>
  <meta name="twitter:site" content="@centurysync">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <!-- Theme Color for Mobile Browsers -->
  <meta name="theme-color" content="#7b61ff">
  <meta name="msapplication-TileColor" content="#7b61ff">

  <!-- DNS Prefetch for External Resources -->
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">

  <!-- Google Fonts - Preconnect -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Font with display=swap for better performance -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Google Analytics 4 -->
  <script is:inline async src="https://www.googletagmanager.com/gtag/js?id=G-JJ1J659Z22"></script>
  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-JJ1J659Z22');
  </script>

  <!-- JSON-LD Structured Data: Organization -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Organization",
    "@id": "https://centurysync.com/#organization",
    "name": "CenturySync",
    "alternateName": "Century Sync",
    "description": "Florida COA management platform built for Century Village West Palm Beach",
    "url": "https://centurysync.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://centurysync.com/logo.png",
      "width": 512,
      "height": 512
    },
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "+1-561-562-4300",
      "contactType": "sales",
      "email": "hello@centurysync.com",
      "areaServed": "US",
      "availableLanguage": "English"
    },
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "100-110 Century Blvd, Suite 202",
      "addressLocality": "West Palm Beach",
      "addressRegion": "FL",
      "postalCode": "33417",
      "addressCountry": "US"
    },
    "sameAs": [
      "https://www.facebook.com/profile.php?id=61575503064716",
      "https://www.instagram.com/century.sync/"
    ],
    "foundingDate": "2011",
    "numberOfEmployees": {
      "@type": "QuantitativeValue",
      "minValue": 1,
      "maxValue": 10
    }
  })} />

  <!-- JSON-LD Structured Data: WebSite (for Sitelinks Search Box) -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "WebSite",
    "@id": "https://centurysync.com/#website",
    "name": "CenturySync",
    "url": "https://centurysync.com",
    "description": "Florida COA management platform built for Century Village West Palm Beach",
    "publisher": {
      "@id": "https://centurysync.com/#organization"
    },
    "inLanguage": "en-US"
  })} />

  <!-- JSON-LD Structured Data: SoftwareApplication -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "CenturySync",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web, iOS, Android",
    "description": "COA management platform with document storage, owner communication, compliance tracking, and mobile apps for Florida condominium associations.",
    "url": "https://centurysync.com",
    "offers": {
      "@type": "Offer",
      "price": "79.00",
      "priceCurrency": "USD",
      "priceValidUntil": "2026-12-31",
      "description": "Monthly base fee plus $1.50 per unit"
    },
    "provider": {
      "@id": "https://centurysync.com/#organization"
    },
    "featureList": [
      "Unlimited document storage",
      "Full-text search",
      "Email and SMS notifications",
      "Mobile apps for iOS and Android",
      "Compliance deadline tracking",
      "Tenant and lease management",
      "Public-facing community websites",
      "Cross-building board forum"
    ]
  })} />

  <!-- JSON-LD Structured Data: LocalBusiness (for Office Hours) -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "@id": "https://centurysync.com/#localbusiness",
    "name": "CenturySync Office Hours",
    "description": "Weekly in-person office hours for Century Village board members",
    "url": "https://centurysync.com",
    "telephone": "+1-561-562-4300",
    "email": "hello@centurysync.com",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "100-110 Century Blvd, Suite 202",
      "addressLocality": "West Palm Beach",
      "addressRegion": "FL",
      "postalCode": "33417",
      "addressCountry": "US"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 26.6974,
      "longitude": -80.1067
    },
    "openingHoursSpecification": {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": "Wednesday",
      "opens": "14:00",
      "closes": "17:00"
    },
    "priceRange": "$$"
  })} />

  <!-- JSON-LD Structured Data: Event (Recurring Office Hours) -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "Event",
    "name": "CenturySync Office Hours",
    "description": "Free weekly drop-in office hours for Century Village board members. Get help with CenturySync, ask questions, or schedule a demo. No appointment needed.",
    "url": "https://centurysync.com/#pricing",
    "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
    "eventStatus": "https://schema.org/EventScheduled",
    "startDate": "2026-01-08T14:00:00-05:00",
    "endDate": "2026-01-08T17:00:00-05:00",
    "eventSchedule": {
      "@type": "Schedule",
      "byDay": "https://schema.org/Wednesday",
      "startTime": "14:00:00",
      "endTime": "17:00:00",
      "scheduleTimezone": "America/New_York",
      "repeatFrequency": "P1W"
    },
    "location": {
      "@type": "Place",
      "name": "CenturySync Office - Century Village",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "100-110 Century Blvd, Suite 202",
        "addressLocality": "West Palm Beach",
        "addressRegion": "FL",
        "postalCode": "33417",
        "addressCountry": "US"
      }
    },
    "organizer": {
      "@type": "Organization",
      "name": "CenturySync",
      "url": "https://centurysync.com"
    },
    "isAccessibleForFree": true,
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "availability": "https://schema.org/InStock",
      "validFrom": "2025-01-01"
    }
  })} />
</head>
<body class="font-sans antialiased text-gray-900 overflow-x-hidden">
  <!-- Skip to content link for keyboard users -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <Header />

  <main id="main-content">
    <slot />
  </main>

  <Footer />

  <!-- Scroll Reveal Script -->
  <script is:inline>
    // Enable JS-based animations (progressive enhancement)
    document.documentElement.classList.add('js-enabled');

    // Premium scroll reveal animation with stagger support
    function reveal() {
      const reveals = document.querySelectorAll('.reveal');
      const windowHeight = window.innerHeight;

      reveals.forEach((element) => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 100; // Trigger earlier for smoother feel

        if (elementTop < windowHeight - elementVisible) {
          // Add staggered delay for grid children
          const parent = element.closest('.reveal-stagger');
          if (parent) {
            const siblings = Array.from(parent.querySelectorAll('.reveal'));
            const siblingIndex = siblings.indexOf(element);
            element.style.transitionDelay = `${siblingIndex * 75}ms`;
          }
          element.classList.add('active');
        }
      });
    }

    // Use requestAnimationFrame for smooth scroll handling
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          reveal();
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });

    // Initial reveal - run when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', reveal);
    } else {
      reveal();
    }
    // Also run on load as fallback
    window.addEventListener('load', reveal);

    // Number counter animation
    function animateCounters() {
      const counters = document.querySelectorAll('.counter');
      counters.forEach(counter => {
        const text = counter.textContent;
        const hasPlus = text.includes('+');
        const hasPercent = text.includes('%');
        const hasK = text.includes('K');
        const hasComma = text.includes(',');
        let target = parseInt(text.replace(/[^0-9]/g, ''));
        if (hasK) target = parseInt(text.replace('K', '').replace('+', ''));
        if (hasComma) target = parseInt(text.replace(',', ''));
        let current = 0;
        const increment = target / 50;
        const stepTime = 40;
        const timer = setInterval(() => {
          current += increment;
          if (current >= target) {
            current = target;
            clearInterval(timer);
          }
          let displayValue = Math.floor(current);
          if (hasComma && displayValue >= 1000) displayValue = displayValue.toLocaleString();
          if (hasK) displayValue = displayValue + 'K';
          if (hasPlus) displayValue = displayValue + '+';
          if (hasPercent) displayValue = displayValue + '%';
          counter.textContent = displayValue;
        }, stepTime);
      });
    }

    // Trigger counter animation when in view
    const counterObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          animateCounters();
          counterObserver.unobserve(entry.target);
        }
      });
    }, { threshold: 0.5 });
    const statsSection = document.querySelector('.counter')?.closest('section');
    if (statsSection) counterObserver.observe(statsSection);

  </script>
</body>
</html>
